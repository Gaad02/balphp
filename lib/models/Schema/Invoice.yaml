
# ==============================================
# BAL INVOICE

Bal_InvoiceItem:
    actAs:
        SoftDelete:
    columns:
        id:
            type: integer(2)
            primary: true
            unsigned: true
            autoincrement: true
        title:
            type: string(50)
            notblank: true
        template:
            type: string(50)
            notblank: true
            default: "user_invoiceitem"
            extra:
                auto: true
        
        total:
            # The total amount
            type: decimal(8)
            scale: 2
            notblank: true
            extra:
                currency: true
        amount:
            # The individual item amount
            type: decimal(8)
            scale: 2
            notblank: true
            extra:
                currency: true
        quantity:
            # The total quantity
            type: integer(1)
            notblank: true
            default: 1
        shipping:
            # The total of shipping for the initial item
            type: decimal(8)
            scale: 2
            notblank: true
            default: 0.00
            extra:
                currency: true
        shipping_additional:
            # The total of shipping for the additional items
            type: decimal(8)
            scale: 2
            notblank: true
            default: 0.00
            extra:
                currency: true
        tax:
            # The total tax applied
            type: decimal(8)
            scale: 2
            notnull: true
            default: 0.00
            extra:
                currency: true
        tax_rate:
            # The rate the tax was applied
            type: decimal(8)
            scale: 2
            notnull: true
            default: 0.00
        weight:
            # The total weight of the item(s)
            type: decimal(8)
            scale: 2
            notblank: true
        weight_unit:
            # The unit which the item(s) were weighed
            type: enum
            values: [lbs,kgs]
            notblank: true
            default: kgs
        handling:
            # The handling costs applied
            type: decimal(8)
            scale: 2
            notnull: true
            default: 0.00
            extra:
                currency: true
        discount_amount:
            # The total amount of discount
            type: decimal(8)
            scale: 2
            notnull: true
            default: 0.00
            extra:
                currency: true
        discount_rate:
            # The total rate of discount
            type: decimal(8)
            scale: 2
            notnull: true
            default: 0.00
            
        invoice_id:
            type: integer(2)
            unsigned: true
            notblank: true
    relations:
        Invoice:
            class: Invoice
            local: invoice_id
            foreign: id
            foreignAlias: InvoiceItems
            foreignType: many
            onDelete: "CASCADE"

Bal_Invoice:
    actAs:
        SoftDelete:
        Timestampable:
    columns:
        id:
            type: integer(2)
            primary: true
            unsigned: true
            autoincrement: true
        title:
            type: string(50)
            notblank: true
        template:
            type: string(50)
            notblank: true
            default: "user_invoice"
            extra:
                auto: true
        amount_paid:
            type: decimal(8)
            scale: 2
            notnull: true
            default: 0.00
            extra:
                currency: true
        amount:
            type: decimal(8)
            scale: 2
            notnull: true
            extra:
                currency: true
        subtotal:
            type: decimal(8)
            scale: 2
            notnull: true
            extra:
                currency: true
        tax:
            type: decimal(8)
            scale: 2
            notnull: true
            extra:
                currency: true
        config:
            type: array
            notnull: true
        cache:
            # Cache of any information that may change externally
            type: array
            notnull: true
        
        status:
            type: enum
            values: [pending,published,completed]
            notblank: true
            default: published
        
        File_id:
            type: integer(2)
            unsigned: true
        UserFor_id:
            type: integer(2)
            unsigned: true
        UserFrom_id:
            type: integer(2)
            unsigned: true
    relations:
        File:
            class: File
            local: File_id
            foreign: id
            foreignAlias: Invoices
            foreignType: many
            onDelete: "CASCADE"
        UserFor:
            class: User
            local: UserFor_id
            foreign: id
            foreignAlias: InvoicesFor
        UserFrom:
            class: User
            local: UserFrom_id
            foreign: id
            foreignAlias: InvoicesFrom


Bal_Payment:
    actAs:
        SoftDelete:
        Timestampable:
    columns:
        id:
            type: integer(4)
            primary: true
            autoincrement: true
            unsigned: true
        status:
            type: enum
            values: [created,pending,refunded,processed,completed,canceled_reversal,denied,expired,failed,voided,reversed]
            notblank: true
            default: awaiting
        amount:
            type: decimal(8)
            scale: 2
            notblank: true
            extra:
                currency: true
        details:
            type: string
            notblank: true
            extra:
                html: raw
                
        Invoice_id:
            type: integer(2)
            unsigned: true
        UserFrom_id:
            type: integer(2)
            unsigned: true
    relations:
        Invoice:
            class: Invoice
            local: Invoice_id
            foreign: id
            foreignAlias: Payments
        UserFrom:
            class: User
            local: UserFrom_id
            foreign: id
            foreignAlias: InvoicesFrom
